<app-dialog-formulaire-modification [donnees]="{portefeuilles, portefeuilleNomEnModification}"
                             (abandon)="portefeuilleNomEnModification = undefined"
                             (modifie)="modifierNomPortefeuille($event)"></app-dialog-formulaire-modification>

<app-dialog-selecteur-valeurs [portefeuille]="portefeuilleValeursEnModification"
                       (abandon)="portefeuilleValeursEnModification = undefined"
                       (modifie)="modifierValeursPortefeuille($event)"></app-dialog-selecteur-valeurs>

<app-dialog-editeur-alertes [portefeuille]="portefeuilleAlertesEnModification"
                     (abandon)="portefeuilleAlertesEnModification = undefined"
                     (modifie)="modifierAlertesPortefeuille($event)"></app-dialog-editeur-alertes>

@if (afficherCreation || this.portefeuilles.length === 0) {
  <p-card>
    <h3>{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.CREATION' | translate }}</h3>

    <app-formulaire-creation [portefeuilles]="portefeuilles" (cree)="creerPortefeuille($event)"></app-formulaire-creation>
  </p-card>
}

@if (portefeuilles.length != 0) {
  <p-card>
    <div class="titre">
      <h2>
        {{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.PORTEFEUILLES' | translate }}
      </h2>
      <app-dialog-import-export></app-dialog-import-export>
      <span class="pi pi-plus-circle" (click)="afficherCreation = true"
            title="{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.CREER' | translate }}"></span>
    </div>

    <div cdkDropList class="liste" (cdkDropListDropped)="dropColonne($event)">
      @for (portefeuille of portefeuilles; track portefeuille.nom; let idx = $index) {
        <div cdkDrag class="ligne">
          <div>
            <input type="radio" name="idxPortefeuilleParDefaut" [value]="idx" [checked]="portefeuille.parDefaut"
                   title="{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.PAR_DEFAUT' | translate }}"
                   (change)="changerParDefaut(idx)">
          </div>
          <div class="colonne">
            <div><span class="pi pi-link" (click)="associationValeursPortefeuille(idx)"
                       title="{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.ASSOCIER_VALEUR' | translate }}"></span>
            </div>
            <div><span class="pi pi-bell" (click)="editionAlertesPortefeuille(idx)"
                       title="{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.EDITER_ALERTES' | translate }}"></span>
            </div>
            <div><span class="pi pi-pencil" (click)="modificationNomPortefeuille(idx)"
                       title="{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.RENOMMER' | translate }}"></span>
            </div>
          </div>
          <div><span class="pi pi-trash" (click)="suppressionPortefeuille($event, idx)"
                     title="{{ 'COMPOSANTS.PORTEFEUILLES.GESTION_PORTEFEUILLES.SUPPRIMER' | translate }}"></span>
          </div>
          <app-configuration-portefeuille [portefeuille]="portefeuille"></app-configuration-portefeuille>
        </div>
      }
    </div>
  </p-card>
}
